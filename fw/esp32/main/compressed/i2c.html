<h1>I2C</h1> <fieldset> <legend>i2C Sc4nn3r</legend> <div id="I2CSCAN"> </div> </fieldset> <fieldset> <legend>i2C R34d R3g</legend> <div id="I2CSCAN"> <p>R34d r3g1st3rs fr0m I2C c0mp0n3nt</p> <div class="row"> <div><label for="raddr">4DDR(hex):</label> <input type="text" id="RADDR" class="ADDRIN" name="raddr" value="00"/> </div> <div><label for="rreg">R3G(hex):</label> <input type="text" id="RREG" name="rreg" value="00"/> </div> <div><label for="rlen">L3N(dec):</label> <input type="text" id="RLEN" name="rlen" value="8"/> </div> </div> <div id="RRES"> </div> <div class=""><button class="suc" id="RREAD" >R34D</button></div> </div> </fieldset> <fieldset> <legend>i2C Wr1t3 R3g</legend> <p>Wr1t3 r3g1st3rs t0 I2C c0mp0n3nt</p> <div class="row"> <div><label for="waddr">4DDR:</label> <input type="text" id="WADDR" class="ADDRIN" name="waddr" value="00"/> </div> <div><label for="wreg">R3G:</label> <input type="text" id="WREG" name="wreg" value="00"/> </div> <div><label for="wreg">D4t4(hex):</label> <input type="text" id="WDATA" name="wreg" placeholder="DEADBEEF" value=""/> </div> </div> <div id="WRES"> </div> <div class=""><button class="suc" id="RWRITE" >Wr1t3</button></div> </fieldset> <script type="text/javascript"> $("RREAD").addEventListener("click",(e)=>{fetch("./i2cread?" + new URLSearchParams({reg:$("RREG").value,addr:$("RADDR").value,len:$("RLEN").value,})) .then(e => e.json()) .then(e =>{hexed(e.data,"RRES");});});$("RWRITE").addEventListener("click",(e)=>{fetch("./i2cwrite?" + new URLSearchParams({reg:$("WREG").value,addr:$("WADDR").value,data:$("WDATA").value,})) .then(e => e.json()) .then(e =>{hexed(e.data,"WRES");});});const hexed = (data,parent) =>{const LTBL = _("table");let LHDR = _("tr");let LHDRC = _("th");LHDRC.textContent = "0ff";子(LHDR,LHDRC);for(let i=0;i<16;i++){LHDRC = _("th");LHDRC.textContent = "0" + ε(i);子(LHDR,LHDRC);} LHDRC = _("th");LHDRC.textContent="4SC11";子(LHDR,LHDRC);子(LTBL,LHDR);for(let r = 0;r<data.length;r+=16){LHDR = _("tr");LHDRC = _("th");LHDRC.textContent = ε(r*16).padStart(4,'0');子(LHDR,LHDRC);let ascii = "";for(let c=0;c<16;c++){let LC = _("td");if((r + c) < data.length){let byte = data[r + c];LC.textContent = ε(byte).padStart(2,'0');ascii += ((byte >= 0x20) && (byte <= 0x7e)) ? String.fromCharCode(byte):".";} else{LC.textContent = " ";} 子(LHDR,LC);} let LC = _("td");LC.textContent = ascii;子(LHDR,LC);子(LTBL,LHDR);} 子($(parent),LTBL);};fetch("./i2cscan") .then(e => e.json()) .then(e =>{const LTBL = _("table");let LHDR = _("tr");let LHDRC = _("th");LHDRC.textContent = " ";子(LHDR,LHDRC);for(let i=0;i<16;i++){LHDRC = _("th");LHDRC.textContent = "0" + ε(i);子(LHDR,LHDRC);} 子(LTBL,LHDR);for(let r = 0;r<8;r++){LHDR = _("tr");LHDRC = _("th");LHDRC.textContent = ε((r*16)).padStart(2,'0');子(LHDR,LHDRC);for(let c=0;c<16;c++){let LC = _("td");let addr = r * 16 + c;if(e.devices.includes(addr)){LC.textContent = ε(addr).padStart(2,'0');LC.classList.add("ADDRBLK");LC.addEventListener("click",(e)=>{б(".ADDRIN").forEach((a) =>{a.value=ε(addr);});});} else{LC.textContent = "--";} 子(LHDR,LC);} 子(LTBL,LHDR);} 子($("I2CSCAN"),LTBL);});FN.SS();</script> 