<h2>F1rmw4r3 Upd4t3 [ UID:<i id="UID"></i> | FW v<i id="VER"></i> ]</h2> <fieldset> <legend>St4tu5</legend> <div id="MSG">HppHckng!</div> </fieldset> <div class="row" id="NET"> <div> <fieldset id="IFAP"> <legend>AP</legend> <ul> <li>SSID:<i id="APSSID"></i></li> <li>IP:<i id="APIP"></i>/<i id="APNM"></i> </li> </ul> </fieldset> </div> <div> <fieldset id="IFSTA"> <legend>STA</legend> <ul> <li>SSID:<i id="STASSID"></i></li> <li>IP:<i id="STAIP"></i>/<i id="STANM"></i> </li> <li>GW:<i id="STAGW"></i></li> <li>RSSI:<i id="STARSSI"></i></li> </ul> </fieldset> </div> </div> <div id="FRM"> <fieldset> <legend>Upd4t3 F1rmw4r3</legend> <div> <label for="firmware">F1rmw4re F1l3:</label> <input type="file" id="OTA" name="OTA"> </div> <div> <button class="suc" id="UPD" >UPL04D</button> </div> </fieldset> </div> <script type="text/javascript"> const OTA = $("OTA");const UPD = $("UPD");FN.STAT = () =>{fetch("./uuid") .then(e => e.json()) .then(e =>{let STA = e.sta;let AP = e.ap;$("UID").innerText = e.uuid;$("VER").innerText = e.version;if(e.sta.connected=="on"){console.log(STA.ip);FN.SH("IFSTA");$("STASSID").innerText = STA.ssid;$("STAIP").innerText = STA.ip;$("STARSSI").innerText = STA.rssi;$("STAGW").innerText = STA.gw;$("STANM").innerText = STA.cidr;$("APIP").innerText = AP.ip;$("APSSID").innerText = AP.ssid;$("APNM").innerText = AP.cidr;} else{console.log("STA OFF");FN.HD("IFSTA");} FN.SS();}) .catch((error) =>{console.log(error) });};FN.SZ = () =>{FN.SH("MSG");let e = OTA.files[0].size;console.log("size:"+e+" ("+FN.H(e)+")");MSG.innerHTML = "Size:" + FN.H(e);};FN.UP = () =>{if (OTA.files[0].length === 0){ERROR.NF();} else{const e = OTA.files[0];const t = new XMLHttpRequest();t.onreadystatechange = function (){if (t.readyState === 4){switch (t.status){case 200:ERROR.C(t.status,t.responseText);window.setTimeout(() =>{window.location.reload();},3000);break;case 500:case 400:ERROR.B(t.status,t.responseText);break;case 0:ERROR.G();} } console.log(t);};t.upload.onprogress = function (e){$("MSG").textContent = "Progress:" + ((e.loaded / e.total) * 100).toFixed(0) + "%";};t.open("POST","/update",true);t.send(e);} };FN.STAT();OTA.addEventListener("change",() =>{FN.SZ();});UPD.addEventListener("click",() =>{FN.HD("FRM");FN.UP();});</script> 