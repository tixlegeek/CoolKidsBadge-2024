<h1>W1f1 Configuration</h1> <fieldset> <legend>AP m0d3 C0nf1gur4t10n</legend> <div> This is related to Access point mode of the CoolKidsBadge. </div> <div> <label for="apssid">ESSID:</label> <input type="text" id="APSSID" name="apssid" value="x"> </div> <div> <label for="appwd">Password:</label> <input type="password" id="APPWD" name="appwd" value="x"> </div> <div> <button id="APSEND" >S4V3 AP</button> </div> </fieldset> <fieldset> <legend>D3t3ct3d APs</legend> <div> These are nearby accesspoints. </div> <div id="STAAPH"> <div> <div class="essid"> ESSID </div> <div class="channel"> Channel </div> <div class="rssi"> RSSI </div> <div class="auth"> AUTH </div> </div> </div> <div id="STAAPLST"> </div> </fieldset> <fieldset> <legend>STA m0d3 C0nf1gur4t10n</legend> <div> This is related to STAtion mode of the CoolKidsBadge. </div> <div><label for="stassid">ESSID:</label> <select id="STASSID" name="stassid"> </select> </div> <div> <label for="stapwd">Password:</label> <input type="password" id="STAPWD" name="stapwd" value=""> </div> <div> <button id="STASEND" >S4V3 STA</button> </div> </fieldset> <script type="text/javascript"> let ERR="NONE";FN.STAT = () =>{fetch("./uuid") .then(e => e.json()) .then(e =>{let AP = e.ap;$("APSSID").value = AP.ssid;$("APPWD").value = AP.password;if(ERR=="NONE") FN.SS();}) .catch((error) =>{ERR="STAT";console.log(error);FN.SE();});};FN.SCAN = ()=>{fetch("./scan") .then(e => e.json()) .then(e =>{e.forEach(function (ap){const APS = _("div");APS.classList.add('APS');const essid = _("div");essid.classList.add("essid");essid.innerText = ap.ssid;const channel = _("div");channel.classList.add("channel");channel.innerText = ap.channel;const rssi = _("div");rssi.classList.add("rssi");rssi.innerText = ap.rssi_dbm;const auth = _("div");auth.classList.add("auth");auth.innerText = ap.authmode;const option = _("option");option.text=ap.ssid;option.value=ap.ssid;$("STASSID").add(option);APS.appendChild(essid);APS.appendChild(channel);APS.appendChild(rssi);APS.appendChild(auth);$("STAAPLST").appendChild(APS);});if(ERR=="NONE") FN.SS();}) .catch((error) =>{ERR="SCAN";console.log(error);FN.SE();});;};FN.APCONF = () =>{fetch("./apconf",{method:"POST",body:"essid=" + btoa($("APSSID").value) + "&password=" + btoa($("APPWD").value),}) .then(e =>{ERROR.C(e.status,e.text());});};FN.STACONF = () =>{console.log("STACONF CALLED");fetch("./staconf",{method:"POST",body:"essid=" + btoa($("STASSID").value) + "&password=" + btoa($("STAPWD").value),}) .then(e =>{ERROR.C(e.status,e.text());});};$("APSEND").addEventListener("click",() =>{FN.APCONF();});$("STASEND").addEventListener("click",() =>{FN.STACONF();});FN.STAT();FN.SCAN();</script> 